<div class="character-container" *ngIf="title || details?.length">
  <header class="header">
    <p class="pre-title">{{ subtitle }}</p>
    <div class="title-divider"></div>
    <h1 class="main-title">{{ title }}</h1>
  </header>

  <main class="content-grid">
    <div class="info-column">
      <section class="details-section" *ngIf="details?.length">
        <h2>Details:</h2>
        <ul class="details-list">
          <li *ngFor="let d of details">
            <strong>{{ d.label }}:</strong> {{ d.value }}
          </li>
        </ul>
      </section>

      <section class="homeworld-section" *ngIf="planet">
        <h2>Heimatplanet:</h2>
        <div class="chip planet-chip">{{ planet }}</div>
      </section>

      <section class="films-section" *ngIf="films?.length">
        <h2>Filme:</h2>
        <div class="chips-container">
          <!-- Render either first N or all films depending on toggle state -->
          <div class="chip film-chip"
               *ngFor="let film of displayedFilms"
               (click)="navigateToFilm(film)"
               role="button"
               tabindex="0"
               [attr.aria-label]="'Ã–ffne ' + formatFilm(film)">
            {{ formatFilm(film) }}
          </div>
          <!-- Ellipsis chip: visible only when more than maxCollapsedCount and currently collapsed -->
          <button *ngIf="isMoreThanMax() && !showAllFilms"
                  class="chip film-chip"
                  type="button"
                  (click)="openAddFilmPopup()"
                  [attr.aria-expanded]="showAllFilms"
                  title="Weitere Filme anzeigen">
            ...
          </button>
        </div>
      </section>
    </div>

    <div class="image-column" *ngIf="images?.length">
      <img [src]="currentImage$ | async"
           alt="image"
           class="character-image">
      <div class="pagination-dots" *ngIf="images.length > 1">
        <span class="dot"
              *ngFor="let img of images; let i = index"
              [class.active]="(currentImageIndex$ | async) === i"
              (click)="selectImage(i)"></span>
      </div>
    </div>
  </main>
</div>
